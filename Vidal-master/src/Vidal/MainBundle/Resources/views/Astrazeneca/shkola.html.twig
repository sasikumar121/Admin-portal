{% extends 'VidalMainBundle::layout_promo.html.twig' %}


{% block middle %}
<noindex>
<div class="pages">
{# Школа гастрита #}
<div class="page page-main">
	<img src="{{ asset('bundles/vidalmain/images/shkola/page-main.png') }}" class="page-main-bg"/>

	<div class="main-links">
		<a href="#articles" class="link">СТАТЬИ</a>
		<a href="#video" class="link">ВИДЕО</a>
		<a href="#test" class="link">ТЕСТ</a>
		<a href="#qa" class="link">КОНСУЛЬТАЦИИ</a>
		<a href="#map" class="link">КАРТА</a>
	</div>

	<div class="context left top">
		<div class="main-title">
			ШКОЛА<br/>ГАСТРИТА
		</div>

		<div class="main-about">
			Для профилактики гастрита рекомендуем Вам проконсультироваться со специалистом.
			Найти специалиста рядом с Вами Вы можете с помощью
			<a href="#map" class="link">нашей карты</a>
		</div>

		<div class="texts">
			{% for blog in blogs %}
				<div class="text-{{ blog.id }} {{ loop.first ? 'active' }}">
					{{ blog.text|raw }}
				</div>
			{% endfor %}
		</div>
	</div>

	<div class="blogs">
		<div class="r-left">
			<img src="{{ asset('bundles/vidalmain/images/bg/r-left.png') }}"/>
		</div>
		<div class="r-right">
			<img src="{{ asset('bundles/vidalmain/images/bg/r-right.png') }}"/>
		</div>

		<div class="images">
			{% for blog in blogs %}
				<div class="image-{{ blog.id }} {{ loop.first ? 'active' }}">
					<img src="{{ blog.photo.path }}"/>
				</div>
			{% endfor %}
		</div>
		<div class="slider">
			<div>
				{% for blog in blogs %}
					<a href="#" data="{{ blog.id }}" {{ loop.first ? 'class="active"' }}></a>
				{% endfor %}
			</div>
		</div>
	</div>
</div>

{# Статьи #}
<div class="page page-articles" id="articles">
	<div class="content">
		<div class="content-title">СПРАВОЧНАЯ ИНФОРМАЦИЯ</div>
		<div class="articles">
			{% for article in articles %}
				<div class="article article-{{ article.id }} {{ loop.index == 1 ? 'active' }}"
					 data="{{ article.id }}">
					<div class="article-img">
						{% if article.photo and is_file(article.photo.path) %}
							<img src="{{ article.photo.path }}"/>
						{% endif %}
					</div>
					<div class="article-text">
						<div class="article-title">
							{{ article.title|upper }}
						</div>
						<div class="article-anons">{{ article.anons|raw }}</div>
					</div>
					<div class="article-body">
						{{ article.body|raw }}
					</div>
				</div>
			{% endfor %}
		</div>
	</div>

	<div class="roller">
		<div>
			{% for article in articles %}
				<a href="#" data="{{ article.id }}" {{ loop.first ? 'class="active"' }}></a>
			{% endfor %}
		</div>
	</div>

	<a class="p-left" href="#"><img src="{{ asset('bundles/vidalmain/images/shkola/p-left.png') }}"/></a>
	<a class="p-right" href="#"><img src="{{ asset('bundles/vidalmain/images/shkola/p-right.png') }}"/></a>
</div>

{# Видео #}
<div class="page page-video" id="video">
	<div class="scroller">
		<div>
			<a href="#" data="{{ 1 }}" class="active"></a>
			<a href="#" data="{{ 2 }}"></a>
			<a href="#" data="{{ 3 }}"></a>
			<a href="#" data="{{ 4 }}"></a>
			<a href="#" data="{{ 5 }}"></a>
		</div>
	</div>

	<a class="s-left" href="#"><img src="{{ asset('bundles/vidalmain/images/shkola/l.png') }}"/></a>
	<a class="s-right" href="#"><img src="{{ asset('bundles/vidalmain/images/shkola/r.png') }}"/></a>

	<div class="content">
		<div class="content-title">ВИДЕО</div>
		<div class="videos">
			<div class="video video-1 active">
				<div class="video-title">
					<b>СИМПТОМЫ ГАСТРИТА</b>

					<div>Читает профессор, д.м.н. Щербаков Петр Леонидович,
						руководитель отдела диагностической эндоскопии
						Московского клинического научно-практического центра
					</div>
				</div>
				<div id="video1" class="video-flv"></div>
				<script type="text/javascript">
					var so = new SWFObject('/players/uppod.swf', 'mpl', '480', '270', '8');
					so.addParam('allowscriptaccess', 'always');
					so.addParam('allowfullscreen', 'true');
					so.addVariable('height', '270');
					so.addVariable('width', '480');
					so.addVariable('file', '/upload/video/astrazeneca/1_2.flv');
					so.addVariable('bufferlength', '10');
					so.addVariable('autostart', 'false');
					so.addVariable('enablejs', 'true');
					so.write('video1');
				</script>
			</div>

			<div class="video video-2">
				<div class="video-title">
					<b>ЧТО ТАКОЕ ГАСТРИТ</b>

					<div>Читает профессор, д.м.н. Щербаков Петр Леонидович,
						руководитель отдела диагностической эндоскопии
						Московского клинического научно-практического центра
					</div>
				</div>
				<div id="video2" class="video-flv"></div>
				<script type="text/javascript">
					var so = new SWFObject('/players/uppod.swf', 'mpl', '480', '270', '8');
					so.addParam('allowscriptaccess', 'always');
					so.addParam('allowfullscreen', 'true');
					so.addVariable('height', '270');
					so.addVariable('width', '480');
					so.addVariable('file', '/upload/video/astrazeneca/2.flv');
					so.addVariable('bufferlength', '10');
					so.addVariable('autostart', 'false');
					so.addVariable('enablejs', 'true');
					so.write('video2');
				</script>
			</div>

			<div class="video video-3">
				<div class="video-title">
					<b>ЯЗВЕННАЯ БОЛЕЗНЬ</b>

					<div>Читает профессор, д.м.н. Щербаков Петр Леонидович,
						руководитель отдела диагностической эндоскопии
						Московского клинического научно-практического центра
					</div>
				</div>
				<div id="video3" class="video-flv"></div>
				<script type="text/javascript">
					var so = new SWFObject('/players/uppod.swf', 'mpl', '480', '270', '8');
					so.addParam('allowscriptaccess', 'always');
					so.addParam('allowfullscreen', 'true');
					so.addVariable('height', '270');
					so.addVariable('width', '480');
					so.addVariable('file', '/upload/video/astrazeneca/3.flv');
					so.addVariable('bufferlength', '10');
					so.addVariable('autostart', 'false');
					so.addVariable('enablejs', 'true');
					so.write('video3');
				</script>
			</div>

			<div class="video video-4 article">
				<div class="video-title">
					<b>КАК ЗАЩИТИТЬСЯ ОТ ГАСТРИТА</b>

					<div>Читает профессор, д.м.н. Щербаков Петр Леонидович,
						руководитель отдела диагностической эндоскопии
						Московского клинического научно-практического центра
					</div>
				</div>
				<div id="video4" class="video-flv"></div>
				<script type="text/javascript">
					var so = new SWFObject('/players/uppod.swf', 'mpl', '480', '270', '8');
					so.addParam('allowscriptaccess', 'always');
					so.addParam('allowfullscreen', 'true');
					so.addVariable('height', '270');
					so.addVariable('width', '480');
					so.addVariable('file', '/upload/video/astrazeneca/4.flv');
					so.addVariable('bufferlength', '10');
					so.addVariable('autostart', 'false');
					so.addVariable('enablejs', 'true');
					so.write('video4');
				</script>
			</div>

			<div class="video video-5 article">
				<div class="video-title">
					<b>ПОЧЕМУ НУЖНО ХОДИТЬ К ВРАЧУ</b>

					<div>Читает профессор, д.м.н. Щербаков Петр Леонидович,
						руководитель отдела диагностической эндоскопии
						Московского клинического научно-практического центра
					</div>
				</div>
				<div id="video5" class="video-flv"></div>
				<script type="text/javascript">
					var so = new SWFObject('/players/uppod.swf', 'mpl', '480', '270', '8');
					so.addParam('allowscriptaccess', 'always');
					so.addParam('allowfullscreen', 'true');
					so.addVariable('height', '270');
					so.addVariable('width', '480');
					so.addVariable('file', '/upload/video/astrazeneca/5.flv');
					so.addVariable('bufferlength', '10');
					so.addVariable('autostart', 'false');
					so.addVariable('enablejs', 'true');
					so.write('video5');
				</script>
			</div>
		</div>
	</div>
</div>

{# Тестирование #}
<div class="page page-test" id="test">
	<div class="content">
		<div class="content-title">ТЕСТИРОВАНИЕ</div>

		<img src="{{ asset('bundles/vidalmain/images/shkola/bg-test.png') }}" class="page-test-bg"/>

		<div class="test-images">
			{% for test in tests %}
				<img src="{{ asset('bundles/vidalmain/images/test' ~test.id~ '.jpg') }}"
					{{ loop.first ? 'class="active"' }} />
			{% endfor %}
		</div>
		<div class="test-content">
			{% for test in tests %}
				<div class="question {{ loop.first ? 'active' }} {{ loop.last ? 'last' }}">
					{{ test.title|upper }}
				</div>
			{% endfor %}
			<div class="test-buttons">
				<a class="btn-red no" href="#">Нет</a>
				<a class="btn-red yes" href="#">Да</a>
			</div>
			<div class="result positive">
				<p>У Вас высока вероятность гастрита, рекомендуем Вам пройти консультацию у
					врача-гастроэнтеролога.</p>

				<p>Найти специалистов Вы можете с помощью
					<a href="{{ path('shkola_gastrita') }}#map">нашей карты</a></p>
			</div>
			<div class="result negative">
				<p>Скорее всего, у Вас нет гастрита, но, для его профилактики проконсультируйтесь
					со специалистом.</p>

				<p>Найти специалистов Вы можете с помощью
				<a href="{{ path('shkola_gastrita') }}#map">нашей карты</a></p>
			</div>
		</div>
	</div>
</div>

{# Вопрос-ответ #}
<div class="page-qa" id="qa">
	<img src="{{ asset('bundles/vidalmain/images/shkola/stat.jpg') }}" class="stat"/>

	<div class="content-title">КОНСУЛЬТАЦИИ</div>


	{% if app.session.flashbag.get('questioned')|length %}
		<div class="questioned">
			Спасибо за ваш вопрос! В ближайшее время наш специалист на него ответит.
		</div>
	{% else %}
		<div class="ask-form">
			<form method="POST" action="{{ path('shkola_gastrita') }}#qa">
				{{ form_widget(form) }}
			</form>
		</div>
	{% endif %}

	<table class="qas">
		{% for row in questionAnswers|batch(2) %}
			<tr {{ loop.index > 1 ? 'class="rest"' }}>
				{% for qa in row %}
					<td class="qa {{ loop.first ? 'first' : 'last' }}">
						<div class="qa-question">{{ qa.question|raw }}</div>
						<a href="#" class="link">ОТВЕТ</a>

						<div class="qa-answer">
							<div class="qa-answer-label">
								<a href="#" class="qa-answer-close">
									<img src="{{ asset('bundles/vidalmain/images/shkola/close.png') }}"/>
								</a>
								<span>ОТВЕТ:</span>
							</div>
							<div class="qa-answer-text">{{ qa.answer|raw }}</div>
						</div>
					</td>
				{% endfor %}
			</tr>
		{% endfor %}
	</table>

	{% if questionAnswers|length > 2 %}
		<div class="center">
			<a class="link qa-rest" href="#">ПОКАЗАТЬ ЕЩЕ</a>
		</div>
	{% endif %}
</div>

{# Карта аптек #}
<div id="map">
	<div class="content-title">КАРТА АПТЕК И БОЛЬНИЦ</div>
	<iframe src="{{ path('shkola_map') }}" style="width:995px; height:496px; border:none;"></iframe>
</div>
</noindex>

{% endblock %}


{% block footer %}
	<div class="footer">
		<noindex>
			<div class="footer-info">
				Информация о препаратах, отпускаемых по рецепту, размещенная на сайте, предназначена только для
				специалистов.
				Информация, содержащаяся на сайте, не должна использоваться пациентами для принятия самостоятельного
				решения о применении представленных лекарственных препаратов и не может служить заменой очной
				консультации врача.
			</div>
		</noindex>

		<div class="footer-copyright caption">
			© 2014 «Школа Гастрита» - Справочная информация по язве желудка и гастрите
		</div>

		<img class="footer-logo" src="{{ asset('bundles/vidalmain/images/vidal-group.jpg') }}" alt="Vidal group"/>
	</div>
{% endblock %}


{% block stylesheets %}
	{{ parent() }}
	<link rel="stylesheet" type="text/css" href="{{ asset('bundles/vidalmain/stylesheets/shkola_gastrita.css') }}"/>
{% endblock %}


{% block javascripts %}
{{ parent() }}
<script src="/bundles/vidalmain/javascripts/swfobject.js" type="text/javascript"></script>
<script type="text/javascript">
	var sliderTimeout = 25000;
	var next = 1;
	var t = 0;

	$(document).ready(function() {
		var sliderInterval = setInterval(slider, sliderTimeout);

		// slider
		$('.slider a').click(function(e) {
			e.preventDefault();
			var $this = $(this);
			var id = $this.attr('data');

			$('.slider a.active, .images div.active, .texts div.active').removeClass('active');
			$this.addClass('active');
			$('.image-' + id).addClass('active');
			$('.text-' + id).addClass('active');

			clearInterval(sliderInterval);
			sliderInterval = setInterval(slider, sliderTimeout);

			return false;
		});
		$('.r-left').click(function() {
			$('.slider a.active').removeClass('active').prevOrLast().addClass('active');
			$('.images div.active').removeClass('active').prevOrLast().addClass('active');
			$('.texts div.active').removeClass('active').prevOrLast().addClass('active');
			clearInterval(sliderInterval);
			sliderInterval = setInterval(slider, sliderTimeout);
		});
		$('.r-right').click(function() {
			$('.slider a.active').removeClass('active').nextOrFirst().addClass('active');
			$('.images div.active').removeClass('active').nextOrFirst().addClass('active');
			$('.texts div.active').removeClass('active').nextOrFirst().addClass('active');
			clearInterval(sliderInterval);
			sliderInterval = setInterval(slider, sliderTimeout);
		});

		// articles
		$('.p-left').click(function(e) {
			e.preventDefault();
			$('.articles .active').removeClass('active').prevOrLast().addClass('active');
			$('.roller .active').removeClass('active').prevOrLast().addClass('active');
			resetArticles();

			return false;
		});

		$('.p-right').click(function(e) {
			e.preventDefault();
			$('.articles .active').removeClass('active').nextOrFirst().addClass('active');
			$('.roller .active').removeClass('active').nextOrFirst().addClass('active');
			resetArticles();

			return false;
		});

		$('.roller a').click(function(e) {
			e.preventDefault();
			var $this = $(this);
			var id = $this.attr('data');
			$('.articles .active, .roller .active').removeClass('active');
			$this.addClass('active');
			$('.article-' + id).addClass('active');
			resetArticles();

			return false;
		});

		$('.article').click(function() {
			var $this = $(this);
			$this.find('.article-text, .article-img').hide();
			$this.find('.article-body').show();
		});

		$('.article-body').click(function(e) {
			e.stopPropagation();
			var $this = $(this);
			var $article = $this.closest('.article');
			$article.find('.article-body').hide();
			$article.find('.article-text, .article-img').show();
		});

		// test
		$('.test-buttons a').click(function(e) {
			e.preventDefault();
			next++;
			var $question = $('.question.active');

			if ($question.hasClass('last')) {
				showResult();
				return false;
			}

			$question.removeClass('active').next().addClass('active');
			$('.test-images .active').removeClass('active').next().addClass('active');

			if ($(this).hasClass('yes')) {
				t++;
			}
		});

		// question-answer
		$('.qa > a').click(function(e) {
			e.preventDefault();
			var $this = $(this);
			var $qa = $this.closest('.qa');
			var $qaNext = $qa.nextOrFirst();
			$this.hide();
			$qa.find('.qa-answer').show();
		});

		$('.qa-answer-close').click(function(e) {
			e.preventDefault();
			var $this = $(this);
			var $qa = $this.closest('.qa');
			$this.closest('.qa-answer').hide();
			$qa.find('> a').show();
		});

		if ($('.form_error ul').length) {
			$('#ask').hide();
			$('.ask-form').show();
		}

		$('.qa-rest').click(function(e) {
			var $link = $(this);
			e.preventDefault();
			$('.qas .rest').slideDown('fast', function() {
				$link.remove();
			});
		});

		// video
		$('.s-left').click(function(e) {
			e.preventDefault();
			$('.videos .active').removeClass('active').prevOrLast().addClass('active');
			$('.scroller .active').removeClass('active').prevOrLast().addClass('active');

			return false;
		});

		$('.s-right').click(function(e) {
			e.preventDefault();
			$('.videos .active').removeClass('active').nextOrFirst().addClass('active');
			$('.scroller .active').removeClass('active').nextOrFirst().addClass('active');

			return false;
		});

		$('.scroller a').click(function(e) {
			e.preventDefault();
			var $this = $(this);
			var id = $this.attr('data');
			$('.videos .active, .scroller .active').removeClass('active');
			$this.addClass('active');
			$('.video-' + id).addClass('active');


			return false;
		});
	});

	jQuery.fn.nextOrFirst = function(selector) {
		var next = this.next(selector);
		return (next.length) ? next : this.prevAll(selector).last();
	};
	jQuery.fn.prevOrLast = function(selector) {
		var prev = this.prev(selector);
		return (prev.length) ? prev : this.nextAll(selector).last();
	};

	function resetArticles() {
		$('.article-body').hide();
		$('.article-img, .article-text').show();
	}

	function slider() {
		$('.slider a.active').removeClass('active').nextOrFirst().addClass('active');
		$('.images div.active').removeClass('active').nextOrFirst().addClass('active');
		$('.texts div.active').removeClass('active').nextOrFirst().addClass('active');
	}

	function showResult() {
		$('.question, .test-buttons').hide();
		t > 3
			? $('.result.positive').addClass('active')
			: $('.result.negative').addClass('active');
	}
</script>
{% endblock %}